{"version":3,"sources":["../../src/expo/isExpoElectron.ts","../../src/metro/withExpoElectronAdapter.ts"],"names":[],"mappings":";AAGO,IAAM,qBAAA,GAAyB,OAAO,OAAA,KAAY,WAAA,IAAe,QAAQ,GAAA,IAAO,OAAA,CAAQ,IAAI,aAAA,IAAiB;;;ACA7G,IAAM,uBAAA,GAA0B,CAAC,MAAA,KAAqC;AAC3E,EAAA,MAAM,sBAAA,GAAyB,OAAO,QAAA,EAAU,cAAA;AAGhD,EAAA,MAAM,kBAAkB,qBAAA,GACpB,CAAC,UAAU,CAAA,GACX,CAAC,SAAS,CAAA;AAEd,EAAA,OAAO;AAAA,IACL,GAAG,MAAA;AAAA,IACH,QAAA,EAAU;AAAA,MACR,GAAG,MAAA,CAAO,QAAA;AAAA,MACV,SAAA,EAAW;AAAA,QACT,GAAG,eAAA;AAAA,QACH,GAAI,MAAA,CAAO,QAAA,EAAU,SAAA,IAAa;AAAC,OACrC;AAAA,MACA,cAAA,EAAgB,CAAC,OAAA,EAAS,UAAA,EAAY,QAAA,KAAa;AAEjD,QAAA,MAAM,YAAY,OAAA,CAAQ,gBAAA,IACR,CAAC,OAAA,CAAQ,gBAAA,CAAiB,SAAS,cAAc,CAAA;AAEnE,QAAA,IAAI,cAAA,GAAiB,QAAA;AAErB,QAAA,IAAI,SAAA,EAAW;AACb,UAAA,IAAI,qBAAA,EAAuB;AAEzB,YAAA,cAAA,GAAiB,UAAA;AAAA,UACnB,CAAA,MAAA,IAAW,aAAa,KAAA,EAAO;AAE7B,YAAA,cAAA,GAAiB,SAAA;AAAA,UACnB;AAAA,QACF;AAEA,QAAA,IAAI,sBAAA,EAAwB;AAC1B,UAAA,OAAO,sBAAA,CAAuB,OAAA,EAAS,UAAA,EAAY,cAAc,CAAA;AAAA,QACnE;AACA,QAAA,OAAO,OAAA,CAAQ,cAAA,CAAe,OAAA,EAAS,UAAA,EAAY,cAAc,CAAA;AAAA,MACnE;AAAA;AACF,GACF;AACF","file":"index.mjs","sourcesContent":["// isMetroElectronConfig.ts\r\n// Checks if we're running in the context of the Metro Bundler for Electron.\r\n\r\nexport const isExpoElectronRuntime = (typeof process !== 'undefined' && process.env && process.env.EXPO_PLATFORM == \"electron\");","import { MetroConfig } from 'metro-config';\r\nimport { isExpoElectronRuntime } from '../expo/isExpoElectron';\r\n\r\nexport const withExpoElectronAdapter = (config: MetroConfig): MetroConfig => {\r\n  const originalResolveRequest = config.resolver?.resolveRequest;\r\n  \r\n  // Only add \"browser\" platform if NOT in Electron runtime\r\n  const customPlatforms = isExpoElectronRuntime \r\n    ? [\"electron\"]\r\n    : [\"browser\"];\r\n  \r\n  return {\r\n    ...config,\r\n    resolver: {\r\n      ...config.resolver,\r\n      platforms: [\r\n        ...customPlatforms,\r\n        ...(config.resolver?.platforms || [])\r\n      ],\r\n      resolveRequest: (context, moduleName, platform) => {\r\n        // Only apply custom resolutions for component files in our app, and not for node_modules\r\n        const isAppCode = context.originModulePath && \r\n                          !context.originModulePath.includes('node_modules');\r\n        \r\n        let targetPlatform = platform;\r\n        \r\n        if (isAppCode) {\r\n          if (isExpoElectronRuntime) {\r\n            // In Electron runtime, use \"electron\" platform\r\n            targetPlatform = \"electron\";\r\n          } else if (platform === \"web\") {\r\n            // In browser runtime (web but not Electron), use \"browser\" platform\r\n            targetPlatform = \"browser\";\r\n          }\r\n        }\r\n        \r\n        if (originalResolveRequest) {\r\n          return originalResolveRequest(context, moduleName, targetPlatform);\r\n        }\r\n        return context.resolveRequest(context, moduleName, targetPlatform);\r\n      }\r\n    }\r\n  }\r\n}"]}